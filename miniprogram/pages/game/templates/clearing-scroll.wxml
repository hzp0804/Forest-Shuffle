<template name="clearing-scroll">
  <view style="display:flex; align-items:flex-start;" bindtouchstart="onClearingTouchStart" bindtouchend="onClearingTouchEnd">
    <view id="deck-card" style="display:flex; align-items:flex-end; padding: 15rpx 0 0rpx 0rpx; padding-right: 10rpx; flex-shrink:0;">
      <view class="hand-card {{selectedClearingIdx === -2 ? 'selected' : ''}}" bindtap="onDrawCard" style="background:#8e44ad; color:white; border:none; position: relative; overflow: hidden; margin:0;">
        <block wx:if="{{deckVisual && deckVisual.bgImg}}">
          <view class="card-sprite-native {{deckVisual.cssClass}}" style="background-image: url('{{deckVisual.bgImg}}'); background-size: {{deckVisual.bgSize}}; pointer-events: none;"></view>
          <view class="card-body" style="background:transparent; color:white; z-index:1; width:100%; height:100%; display:flex; flex-direction:column; justify-content:center; align-items:center;">
            <!-- 回合数 (恢复显示) -->
            <view style="font-size:16rpx; font-weight:bold; opacity: 0.9; text-shadow: 0 1px 2px rgba(0,0,0,0.8); margin-bottom: 2rpx; width: 100%; text-align: center; display: block;">
              回合 {{currentTurn || 1}}
            </view>
            <!-- 牌库数量 -->
            <view style="font-size:32rpx; margin-top: 20rpx; font-weight:900; text-shadow: 0 2rpx 4rpx rgba(0,0,0,0.8); line-height: 1; margin-bottom: 4rpx; width: 100%; text-align: center; display: block;">
              {{deckLength || 0}}
            </view>
            <view style="flex: 1;"></view>
            <!-- 冬季卡数量 -->
            <view style="display: flex; align-items: center; justify-content: center; font-size:20rpx; margin-bottom: 12rpx; font-weight:bold; color: #a2e8fa; text-shadow: 0 1px 3px rgba(0,0,0,0.8); background: rgba(0,0,0,0.3); padding: 4rpx 12rpx; border-radius: 10rpx;">
              ❄️ {{gameState.winterCardCount || 0}}/3
            </view>
          </view>
        </block>
      </view>
    </view>
    <scroll-view class="clearing-scroll" scroll-y enhanced show-scrollbar="{{false}}" enable-flex scroll-into-view="{{clearingScrollId}}" scroll-with-animation style="height: 170rpx;" bounces="{{false}}">
      <view class="clearing-row" id="clearing-top">
        <block wx:for="{{clearing}}" wx:key="uid">
          <view id="clearing-{{index}}" class="hand-card clearing-card {{item.effectConfig ? 'has-trigger' : ''}} {{item.bonusConfig ? 'has-reward' : ''}} {{index === selectedClearingIdx ? 'selected' : ''}}" bindtap="onClearingCardTap" bindlongpress="onShowDetail" data-idx="{{index}}" data-type="clearing">
            <view wx:if="{{item.bgImg}}" class="card-sprite-native {{item.cssClass}}" style="background-image: url('{{item.bgImg}}'); background-size: {{item.bgSize}}"></view>
            <view wx:else class="card-header" style="background-color: {{item.color || '#4caf50'}}">
              <text class="card-name">{{item.name}}</text>
            </view>
          </view>
        </block>
        <block wx:for="{{[1,2,3,4,5,6,7,8,9,10]}}" wx:key="*this">
          <view class="hand-card placeholder" wx:if="{{index >= (clearing.length || 0)}}">
            <view class="card-body" style="background: transparent;">+</view>
          </view>
        </block>
        <!-- 滚动锚点 -->
        <view id="clearing-end-anchor" style="width: 1rpx; height: 1rpx; flex-shrink: 0;"></view>
        <!-- 行号指示器 -->
        <view class="clearing-row-number row-1-num">1</view>
        <view class="clearing-row-number row-2-num">2</view>
      </view>
    </scroll-view>
  </view>
</template>