@import "./animations.wxss";
@import "./reward-cards.wxss";

/* Notification Bar State Colors */
.notification-bar.normal {
  color: #ecf0f1;
}

.notification-bar.success {
  color: #2ecc71;
  /* Green */
}

.notification-bar.warning {
  color: #f1c40f;
  /* Yellow */
}

.notification-bar.error {
  color: #e74c3c;
  /* Red */
}

/* Instruction Tip State Colors (手牌区域提示文字) */
.instruction-tip {
  font-size: 24rpx;
  font-weight: bold;
  transition: color 0.3s ease;
}

.instruction-tip.normal {
  color: #bdc3c7;
  /* Gray */
}

.instruction-tip.success {
  color: #2ecc71;
  /* Green */
}

.instruction-tip.warning {
  color: #f1c40f;
  /* Yellow */
}

.instruction-tip.error {
  color: #e74c3c;
  /* Red */
}

/* 通用文本颜色类（用于 instructionLines 内部） */
.text-success {
  color: #2ecc71;
  /* Green */
}

.text-error {
  color: #e74c3c;
  /* Red */
}

.text-warn {
  color: #f1c40f;
  /* Yellow */
}

.text-gray {
  color: #95a5a6;
  /* Gray */
}

.text-bold {
  font-weight: bold;
}

/* 游戏按钮样式 */
.action-bar-inline {
  display: flex !important;
  gap: 12rpx;
  align-items: center;
}

.game-btn {
  margin: 0 !important;
  padding: 0 16rpx !important;
  font-size: 24rpx !important;
  line-height: 52rpx !important;
  height: 52rpx !important;
  border-radius: 8rpx !important;
  background: #2ecc71 !important;
  color: white !important;
  border: none !important;
  font-weight: normal !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
}

.game-btn.draw-btn {
  background: #9b59b6 !important;
}

.game-btn.sapling-btn {
  background: #e67e22 !important;
}

.game-btn.valid-play-btn {
  box-shadow: 0 0 15rpx #2ecc71;
  transform: scale(1.05);
}

.game-btn[disabled],
.game-btn.disabled {
  background: #95a5a6 !important;
  opacity: 0.5 !important;
  color: #bdc3c7 !important;
  pointer-events: none;
  filter: grayscale(100%);
}

.end-turn-text {
  font-size: 24rpx;
  color: #e74c3c;
  font-weight: bold;
  padding: 4rpx 12rpx;
  border: 1rpx solid #e74c3c;
  border-radius: 4rpx;
}

/* 全局容器 */
.game-container {
  display: flex;
  flex-direction: column;
  height: 100vh;
  background-color: #2c3e50;
  color: #ecf0f1;
  overflow: hidden;
  padding-top: calc(env(safe-area-inset-top, 0rpx) + 8rpx);
  box-sizing: border-box;
}

.loading-mask {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  font-size: 32rpx;
  color: #bdc3c7;
}

/* 顶部玩家列表 */
.players-bar {
  height: 80rpx;
  /* 严格保持高度 */
  background: rgba(44, 62, 80, 0.95);
  display: flex;
  flex-direction: row;
  align-items: center;
  padding: 0 12rpx;
  box-sizing: border-box;
  border-bottom: 1rpx solid rgba(255, 255, 255, 0.1);
  overflow-x: hidden;
  /* 强制一屏4个，多余的裁剪（通常只有4人） */
}

.player-slot {
  width: 170rpx;
  /* 增加宽度以容纳更大的分数 */
  flex-shrink: 0;
  height: 70rpx;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 12rpx;
  display: flex;
  flex-direction: row;
  /* 改为横向布局更省空间 */
  align-items: center;
  padding: 0 6rpx;
  overflow: hidden;
  box-sizing: border-box;
  border: 1rpx solid rgba(255, 255, 255, 0.1);
  transition: all 0.2s ease;
  position: relative;
  margin-right: 5rpx;
}

.player-slot:last-child {
  margin-right: 0;
}

.player-slot.is-me {
  background: rgba(241, 196, 15, 0.15);
  border: 2rpx solid #ffd700;
  box-shadow: 0 0 10rpx rgba(241, 196, 15, 0.3);
  z-index: 2;
}

.player-slot.is-viewing {
  /* background: rgba(52, 152, 219, 0.15); */
  /* border: 2rpx solid #3498db; */
  /* box-shadow: 0 0 10rpx rgba(52, 152, 219, 0.3); */
}

.player-slot.selected {
  background: rgba(46, 204, 113, 0.2);
  border: 4rpx solid #2ecc71;
  /* Thicker border for clarity */
  box-shadow: 0 0 16rpx rgba(46, 204, 113, 0.6);
  transform: scale(1.05);
  /* Slight zoom */
  z-index: 10;
}

.player-slot.is-active {
  /* Removed active player highlight per user request */
  /* background: rgba(46, 204, 113, 0.2); */
  /* border: 2rpx solid #2ecc71; */
  /* box-shadow: 0 0 16rpx #2ecc71; */
  /* animation: pulseActivePlayer 1.5s infinite; */
  /* z-index: 3; */
}

@keyframes pulseActivePlayer {
  0% {
    box-shadow: 0 0 8rpx #2ecc71;
  }

  50% {
    box-shadow: 0 0 20rpx #2ecc71;
  }

  100% {
    box-shadow: 0 0 8rpx #2ecc71;
  }
}

.empty-seat {
  color: #7f8c8d;
  font-size: 32rpx;
}

.p-avatar {
  width: 40rpx;
  height: 40rpx;
  border-radius: 50%;
  border: 2rpx solid rgba(255, 255, 255, 0.3);
  margin-right: 6rpx;
  flex-shrink: 0;
}

.p-info {
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
  overflow: hidden;
  min-width: 0;
  /* 允许 flex 项缩小 */
}

.p-name {
  font-size: 14rpx;
  color: #bdc3c7;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  margin-bottom: 0rpx;
  display: block;
}

.p-stats {
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  align-items: center;
  width: 100%;
}

.stat-item {
  font-size: 16rpx;
  font-weight: bold;
  color: #ecf0f1;
  display: flex;
  align-items: center;
  white-space: nowrap;
}

/* 中间：牌桌区域 (Board) */
.game-board {
  background: #34495e;
  padding: 10rpx 20rpx;
  display: flex;
  flex-direction: column;
  /* 禁止整体滚动 */
  align-items: stretch;
  gap: 10rpx;
  flex: 1;
  overflow: hidden;
  margin-top: 5rpx;
}

/* 空地区域 */

/* 区域通用标题 */
.area-label {
  font-size: 24rpx;
  color: #bdc3c7;
  padding-left: 4rpx;
}

/* 空地布局与手牌保持一致 */
/* 空地布局与手牌保持一致 */
.clearing-scroll {
  flex: 1;
  min-width: 0;
  /* 确保在 flex 布局中能正确缩小 */
  white-space: nowrap;
  overflow: hidden;
  /* 必须设为 hidden 以便正常限制滚动区域 */
}

.clearing-row {
  display: flex;
  flex-direction: row;
  align-items: flex-end;
  padding: 15rpx 4rpx 0rpx 20rpx;
  /* 右侧保留最小安全间距 */
  gap: 16rpx;
  box-sizing: border-box;
  width: max-content;
}

.clearing-row .hand-card {
  margin-bottom: 10rpx;
}

.clearing-card {
  animation: slideInUp 0.4s ease-out;
  /* Entry Animation for Clearing */
}

.clearing-card {
  background: #fff;
  transition: transform 0.2s, box-shadow 0.2s;
}

.clearing-card.selected {
  transform: translateY(-10rpx) scale(1.05);
  box-shadow: 0 0 0 6rpx #e74c3c, 0 16rpx 32rpx rgba(0, 0, 0, 0.5);
}

.hand-card.selected {
  transform: translateY(-10rpx) scale(1.05);
  box-shadow: 0 0 0 6rpx #e74c3c, 0 16rpx 32rpx rgba(0, 0, 0, 0.5);
  z-index: 10;
}

.hand-card.placeholder {
  background: rgba(255, 255, 255, 0.1);
  border: 3rpx dashed rgba(255, 255, 255, 0.4);
  /* Slightly thinner border to match size better */
  color: rgba(255, 255, 255, 0.7);
  justify-content: center;
  align-items: center;
  box-shadow: none;
  box-sizing: border-box;
  /* Ensure border is included in width */
}

/* Board 里的卡片样式 */
.small-card {
  width: 100%;
  height: 100%;
  border-radius: 8rpx;
  color: #2c3e50;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  font-size: 16rpx;
  text-align: center;
  padding: 4rpx;
  overflow: hidden;
  box-shadow: 2rpx 2rpx 4rpx rgba(0, 0, 0, 0.3);
}

/* 玩家森林区域 */
.forest-area {
  flex: 1;
  /* 占据剩余空间 */
  background: rgba(0, 0, 0, 0.15);
  border-radius: 12rpx;
  border: 2rpx dashed #5d6d7e;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  position: relative;
  margin-top: 5rpx;
}

.forest-area .area-label {
  font-size: 24rpx;
  color: #bdc3c7;
  padding: 10rpx 0 0 16rpx;
  flex-shrink: 0;
}

/* 确保 forest-scroll 启用纵向滚动 */
.cave-info {
  margin-right: 16rpx;
  display: flex;
  align-items: center;
  color: #f1c40f;
  font-size: 20rpx;
  background: rgba(0, 0, 0, 0.4);
  padding: 6rpx 16rpx;
  border-radius: 12rpx;
  border: 1rpx solid #f1c40f;
}

.forest-scroll {
  width: 100%;
  height: 100%;
  overflow-y: scroll;
}

/* 恢复 Grid 布局：每行3个 */
/* 3 * (200 + 10+10 margin) = 660rpx */
.forest-grid {
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  align-items: flex-start;
  width: 660rpx;
  box-sizing: border-box;
  margin: 0 auto;
  /* 居中显示 */
}

.forest-card {
  width: 96rpx;
  /* 森林里的卡片大小 */
  height: 144rpx;
  background: #ecf0f1;
  border-radius: 8rpx;
  margin-right: 12rpx;
  flex-shrink: 0;
  overflow: visible;
  /* 允许阴影溢出 */
  box-shadow: 2rpx 2rpx 6rpx rgba(0, 0, 0, 0.3);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 16rpx;
  color: #7f8c8d;
  position: relative;
}

/* Hand Card Animation */
.hand-scroll .hand-card {
  animation: slideInUp 0.4s ease-out;
}

.forest-card.placeholder {
  background: rgba(255, 255, 255, 0.05);
  border: 2rpx dashed #95a5a6;
  color: #95a5a6;
}

.sapling-tag {
  position: absolute;
  top: 6rpx;
  left: 6rpx;
  padding: 4rpx 10rpx;
  background: rgba(46, 204, 113, 0.9);
  color: #0b2c18;
  font-size: 14rpx;
  border-radius: 6rpx;
  font-weight: 700;
  z-index: 2;
}

/* --- Tree Group Layout --- */
.tree-group {
  position: relative;
  width: 200rpx;
  height: 288rpx;
  display: flex;
  justify-content: center;
  align-items: center;
  margin: 10rpx;
  flex-shrink: 0;
  transition: transform 0.2s;
  overflow: visible;
  animation: slideInUp 0.4s ease-out;
}

/* 槽位中的卡片图层增加 Entry 动画 (popIn) */
.slot-card .card-sprite-native {
  animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.tree-group.target-active {
  transform: scale(1.03);
  /* Keep the emphasis but avoid clipping inside scroll-view */
  z-index: 5;
}

/* Selection Ring/Glow for Target Tree */

/* Central Tree */
.tree-center {
  width: 96rpx;
  height: 144rpx;
  background: #34495e;
  /* 使用与棋盘一致的底色，防止透出底层的虚线 */
  position: relative;
  border-radius: 8rpx;
  box-shadow: 0 4rpx 8rpx rgba(0, 0, 0, 0.3), 0 0 0 1rpx #34495e;
  /* 增加 1rpx 扩展阴影作为“边缘密封” */
  z-index: 10;
  /* Tree is above slots */
  transition: all 0.3s ease;
}

/* Slots Positioning */
.slot-pos {
  position: absolute;
  z-index: 5;
  /* Ensure slots are clickable above tree/bg */
  /* Empty slots need size and hit area */
  pointer-events: auto;
}

.slot-top {
  top: 0;
  left: 52rpx;
  /* Aligned with centered tree (250-120)/2 */
  transform: none;
  width: 96rpx;
  height: 144rpx;
}

.slot-bottom {
  top: 144rpx;
  /* Starts where tree overlap ends */
  left: 52rpx;
  bottom: auto;
  transform: none;
  width: 96rpx;
  height: 144rpx;
}

/* Slot Card Container */
.slot-card {
  width: 100%;
  height: 100%;
  position: relative;
  overflow: hidden;
  border-radius: 8rpx;
  background: #34495e;
  /* 有卡片时也要遮挡背景 */
  box-shadow: 0 2rpx 6rpx rgba(0, 0, 0, 0.3);
  transition: all 0.2s;
  border: none;
}

.slot-card.empty {
  background: rgba(255, 255, 255, 0.05);
  border: 2rpx dashed rgba(255, 255, 255, 0.3);
  /* 减弱虚线亮度和粗细 */
  box-shadow: none;
}

.slot-pos.valid-target .slot-card {
  background: rgba(46, 204, 113, 0.4) !important;
  border-color: #2ecc71 !important;
  box-shadow: 0 0 12rpx #2ecc71;
}

.slot-pos.invalid-target .slot-card {
  background: rgba(231, 76, 60, 0.4) !important;
  border-color: #e74c3c !important;
}

/* 选中插槽 - 满足打出条件时显示绿色 */
.slot-pos.selected.can-play .slot-card {
  border-color: #2ecc71 !important;
  background: rgba(46, 204, 113, 0.4) !important;
  box-shadow: 0 0 16rpx #2ecc71;
  animation: pulseSlotGreen 1.5s infinite;
}

/* 选中插槽 - 不满足打出条件时显示黄色 */
.slot-pos.selected .slot-card {
  border-color: #f1c40f !important;
  background: rgba(241, 196, 15, 0.3) !important;
  box-shadow: 0 0 16rpx #f1c40f;
  animation: pulseSlot 1.5s infinite;
}

@keyframes pulseSlotGreen {
  0% {
    box-shadow: 0 0 8rpx #2ecc71;
  }

  50% {
    box-shadow: 0 0 20rpx #2ecc71;
  }

  100% {
    box-shadow: 0 0 8rpx #2ecc71;
  }
}

@keyframes pulseSlot {
  0% {
    box-shadow: 0 0 8rpx #f1c40f;
  }

  50% {
    box-shadow: 0 0 20rpx #f1c40f;
  }

  100% {
    box-shadow: 0 0 8rpx #f1c40f;
  }
}

/* Cropping Logic: NOW RESET TO FULL VIEW because we use Overlap */
.slot-crop {
  position: absolute;
  width: 100%;
  height: 100%;
}

/* Top Slot */
.slot-top .slot-crop {
  height: 100% !important;
  top: 0;
}

/* Bottom Slot */
.slot-bottom .slot-crop {
  height: 100% !important;
  top: 0;
}

/* For Side Slots (Left/Right) */
.slot-left {
  left: 5rpx;
  top: 72rpx;
  transform: none;
  width: 96rpx;
  height: 144rpx;
}

.slot-right {
  left: 102rpx;
  right: auto;
  top: 72rpx;
  transform: none;
  width: 96rpx;
  height: 144rpx;
}

.slot-left .slot-crop {
  width: 100% !important;
  height: 100%;
  left: 0;
  top: 0;
}

.slot-right .slot-crop {
  width: 100% !important;
  height: 100%;
  right: 0;
  left: 0;
  top: 0;
}

/* 底部区域：手牌 (Hand) */
/* 底部区域：手牌 (Hand) */
/* 底部区域：手牌 (Hand) */
.hand-area {
  height: 400rpx;
  /* 增加高度以容纳两行 */
  background: #34495e;
  padding: 12rpx 0rpx 6rpx 12rpx;
  display: flex;
  flex-direction: column;
  overflow: visible;
}

.hand-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0 45rpx;
  padding-bottom: 8rpx;
  position: absolute;
  width: 100vw;
  box-sizing: border-box;
  position: relative;
  z-index: 99;
}

.area-title {
  font-size: 24rpx;
  color: #bdc3c7;
  width: 200rpx;
}

.instruction-tip {
  font-size: 24rpx;
  color: #bdc3c7;
  /* Default/Normal */
  font-weight: normal;
  transition: color 0.3s;
}

.instruction-tip.warning {
  color: #f39c12;
  /* Orange */
  display: inline-block;
}

@keyframes notice-shake {

  0%,
  70%,
  100% {
    transform: translateX(0);
    opacity: 1;
  }

  75% {
    transform: translateX(-6rpx);
    opacity: 0.8;
  }

  80% {
    transform: translateX(6rpx);
    opacity: 0.8;
  }

  85% {
    transform: translateX(-6rpx);
    opacity: 0.8;
  }

  90% {
    transform: translateX(6rpx);
    opacity: 0.8;
  }
}

.instruction-tip.action {
  color: #FFD700;
  font-weight: bold;
  text-shadow: 0 0 4rpx rgba(255, 215, 0, 0.5);
  display: inline-block;
  animation: pulse-action 1.5s infinite ease-in-out;
}

@keyframes pulse-action {
  0% {
    transform: scale(1);
    filter: brightness(1);
  }

  50% {
    transform: scale(1.05);
    filter: brightness(1.2);
  }

  100% {
    transform: scale(1);
    filter: brightness(1);
  }
}

.instruction-tip.error {
  color: #f39c12;
  /* Orange */
  display: inline-block;
}

.instruction-tip.success {
  color: #2ecc71;
  /* Green */
}

.hand-scroll {
  width: 100%;
  flex: 1;
  display: block;
  /* 取消flex，由内部grid控制 */
  padding-bottom: 10rpx;
  /* padding-top: 30rpx; */
  /* 给title留空间 */
  overflow-y: scroll;
}

.hand-grid {
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  align-items: flex-start;
  justify-content: flex-start;
  /* gap: 0; */
  /* row-gap: 20rpx; */
  /* column-gap: 25rpx; */
  /* Android compatibility: Use margins instead of gap */
  padding: 0;
  width: 660rpx;
  margin: 20rpx auto;
}

/* 移除 after 伪元素，避免干扰 space-between */
/* .hand-grid::after {
  content: "";
  flex: 0 0 40rpx;
} */

/* 手牌卡片样式 */
.hand-card {
  width: 112rpx;
  height: 168rpx;
  background: #fff;
  border-radius: 8rpx;
  flex-shrink: 0;
  color: #333;
  display: flex;
  flex-direction: column;
  overflow: visible;
  box-shadow: 0 6rpx 12rpx rgba(0, 0, 0, 0.32);
  position: relative;
  transition: transform 0.2s, box-shadow 0.2s;
  margin: 20rpx 25rpx 20rpx 0;
  /* Clear margins except right and bottom */
  box-sizing: border-box;
  /* Ensure borders don't increase width */
}

/* Every 5th card (end of row) has no right margin */
.hand-card:nth-child(5n) {
  margin-right: 0;
}

@keyframes floatYellowLine {

  0%,
  100% {
    transform: translateX(-50%) translateY(0);
    opacity: 0.8;
  }

  50% {
    transform: translateX(-50%) translateY(6rpx);
    opacity: 1;
  }
}

.hand-card.primary-selected {
  transform: translateY(-4rpx) scale(1.05);
  box-shadow: 0 0 0 6rpx #2ecc71, 0 16rpx 32rpx rgba(0, 0, 0, 0.5);
  z-index: 10;
}

.hand-card.primary-selected::after {
  content: none;
  /* 默认不显示 */
}

/* 只有当满足 bonus-active 时才显示黄条 */
.hand-card.primary-selected.bonus-active::after {
  content: "";
  position: absolute;
  top: -20rpx;
  left: 50%;
  transform: translateX(-50%);
  width: 60%;
  height: 8rpx;
  background: #f1c40f;
  border-radius: 4rpx;
  box-shadow: 0 0 8rpx rgba(241, 196, 15, 0.8);
  animation: floatYellowLine 1.5s ease-in-out infinite;
  pointer-events: none;
}

.hand-card.payment-selected {
  transform: translateY(-4rpx) scale(1.05);
  box-shadow: 0 0 0 6rpx #f1c40f, 0 16rpx 32rpx rgba(0, 0, 0, 0.5);
  z-index: 5;
}

.hand-card.selected {
  transform: translateY(-4rpx) scale(1.05);
  box-shadow: 0 0 0 6rpx #f1c40f, 0 16rpx 32rpx rgba(0, 0, 0, 0.5);
  z-index: 5;
}

.pay-flag {
  position: absolute;
  top: 6rpx;
  right: 6rpx;
  background: rgba(149, 165, 166, 0.9);
  color: #fff;
  font-size: 18rpx;
  padding: 4rpx 10rpx;
  border-radius: 6rpx;
  font-weight: 700;
  z-index: 2;
}

.primary-flag {
  position: absolute;
  top: 6rpx;
  left: 6rpx;
  background: rgba(46, 204, 113, 0.95);
  color: #0b2c18;
  font-size: 18rpx;
  padding: 4rpx 10rpx;
  border-radius: 6rpx;
  font-weight: 700;
  z-index: 2;
}

.card-header {
  height: 40rpx;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 4rpx;
  font-size: 16rpx;
  color: white;
}

.card-cost-badge {
  background: rgba(0, 0, 0, 0.3);
  width: 24rpx;
  height: 24rpx;
  border-radius: 50%;
  text-align: center;
  line-height: 24rpx;
  font-weight: bold;
}

.card-body {
  flex: 1;
  padding: 8rpx;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  background: #fdfdfd;
}

.card-type {
  font-size: 14rpx;
  color: #999;
}

.card-tags {
  font-size: 16rpx;
  color: #555;
  margin-top: 2rpx;
}

.card-footer {
  height: 40rpx;
  /* 可放效果文本 */
  background: #eee;
  padding: 4rpx 8rpx;
  display: flex;
  align-items: center;
  justify-content: center;
}

.card-effect-text {
  font-size: 12rpx;
  color: #444;
  overflow: hidden;
  text-overflow: ellipsis;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
}

/* 操作按钮 */
/* 操作按钮 (Top) */
/* 操作按钮 (Top -- Deprecated or used for layout) */
.action-bar-top {
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  gap: 30rpx;
  padding: 12rpx;
  background: rgba(0, 0, 0, 0.25);
  border-radius: 12rpx;
  margin-bottom: 20rpx;
}

/* New Bottom Action Bar */
.action-bar-bottom {
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  gap: 30rpx;
  padding: 12rpx 20rpx;
  background: #273746;
  /* Match Hand Area Header color? Or slightly different */
  border-top: 1rpx solid rgba(255, 255, 255, 0.1);
  width: 100%;
  box-sizing: border-box;
  z-index: 50;
  /* Ensure above stuff */
  /* If we want it sticky? No, it's in flex flow */
}

.game-btn {
  font-size: 24rpx !important;
  background: #2ecc71 !important;
  color: white !important;
}

.game-btn.secondary {
  background: #e74c3c !important;
}

.game-btn.sapling-btn {
  background: #e67e22 !important;
}

.game-btn.draw-btn {
  background: #8e44ad !important;
  /* 紫色，致敬原来的牌库颜色 */
}

.end-turn-text {
  font-size: 24rpx;
  color: #e74c3c;
  font-weight: bold;
  text-decoration: underline;
  padding: 4rpx 8rpx;
  transition: all 0.2s ease;
}

.end-turn-text:active {
  opacity: 0.6;
  transform: scale(0.95);
}

/* Sprite Card Styles */
.card-sprite-viewport {
  position: relative;
  width: 100%;
  height: 100%;
  overflow: hidden;
  border-radius: 12rpx;
}

.card-sprite-img {
  max-width: none;
  max-height: none;
  display: block;
}

.selection-indicator {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 60rpx;
  height: 60rpx;
  background: rgba(255, 255, 255, 0.8);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10;
}

.draw-hint {
  position: absolute;
  bottom: -40rpx;
  left: 50%;
  transform: translateX(-50%);
  font-size: 20rpx;
  color: #666;
  white-space: nowrap;
  background: rgba(255, 255, 255, 0.8);
  padding: 2rpx 8rpx;
  border-radius: 8rpx;
}

/* --- Gallery Style Modal (Copied & Adapted) --- */

.detail-modal-mask {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.85);
  /* Darker backdrop */
  backdrop-filter: blur(5px);
  z-index: 3000;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 40rpx;
  animation: fadeIn 0.2s ease-out;
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }

  to {
    opacity: 1;
  }
}

.preview-card {
  width: 100%;
  max-width: 680rpx;
  background: #ffffff;
  border-radius: 32rpx;
  box-shadow: 0 24rpx 48rpx rgba(0, 0, 0, 0.5);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  max-height: 85vh;
  position: relative;
  animation: scaleIn 0.3s cubic-bezier(0.19, 1, 0.22, 1);
}

@keyframes scaleIn {
  from {
    transform: scale(0.95);
    opacity: 0;
  }

  to {
    transform: scale(1);
    opacity: 1;
  }
}

.preview-header {
  background: #f0f4f1;
  padding: 40rpx;
  display: flex;
  justify-content: center;
  align-items: center;
  border-bottom: 1rpx solid #e1e6e2;
  flex-shrink: 0;
}

.card-sprite-viewport.preview {
  width: 50%;
  /* Adjust size for preview */
  padding-top: 77.5%;
  height: 0;
  position: relative;
  overflow: hidden;
  border-radius: 16rpx;
  box-shadow: 0 12rpx 24rpx rgba(0, 0, 0, 0.15);
  transform: rotate(0deg);
  background: #ccc;
}

.preview-content {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  background: #fff;
}

/* Tree Plant Animation */
.tree-group {
  animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

/* Tabs */
.species-tabs {
  display: flex;
  background: #f7f9f8;
  border-bottom: 1rpx solid #eee;
  flex-shrink: 0;
}

.tab-item {
  flex: 1;
  text-align: center;
  padding: 24rpx;
  font-size: 28rpx;
  color: #666;
  font-weight: 500;
  position: relative;
  transition: all 0.2s;
}

.tab-item.active {
  color: #2a4f25;
  font-weight: 700;
  background: #fff;
}

.tab-item.active::after {
  content: "";
  position: absolute;
  bottom: 0;
  left: 20%;
  width: 60%;
  height: 6rpx;
  background: #2a4f25;
  border-radius: 4rpx 4rpx 0 0;
}

/* Details Scroll */
.details-scroll {
  flex: 1;
  overflow-y: auto;
  padding: 30rpx 40rpx;
  box-sizing: border-box;
}

.detail-header {
  margin-bottom: 30rpx;
  text-align: center;
}

.detail-title {
  font-size: 36rpx;
  font-weight: 800;
  color: #1a1a1a;
}

/* Info Grid */
.info-grid {
  display: flex;
  flex-direction: column;
  gap: 24rpx;
  padding-bottom: 40rpx;
}

.info-row {
  display: flex;
  align-items: center;
  padding-bottom: 16rpx;
  border-bottom: 1rpx dashed #eee;
}

.info-block {
  display: flex;
  flex-direction: column;
  gap: 12rpx;
  background: #f8fbf9;
  /* Light mint background */
  padding: 24rpx;
  border-radius: 16rpx;
}

.info-label {
  font-size: 26rpx;
  color: #2a4f25;
  font-weight: 600;
  width: 140rpx;
  display: flex;
  align-items: center;
  gap: 8rpx;
}

.info-block .info-label {
  width: auto;
  margin-bottom: 4rpx;
}

.info-value {
  flex: 1;
  font-size: 28rpx;
  color: #333;
  display: flex;
  flex-wrap: wrap;
  gap: 12rpx;
}

.info-value-text {
  font-size: 28rpx;
  color: #333;
  line-height: 1.6;
}

.highlight {
  font-weight: 700;
  color: #d35400;
}

.tag-pill {
  background: #e8f5e9;
  color: #2e7d32;
  font-size: 22rpx;
  padding: 4rpx 16rpx;
  border-radius: 12rpx;
  font-weight: 600;
}

/* Turn Summary Modal Styles */
.summary-modal-mask {
  position: fixed;
  inset: 0;
  background: rgba(0,
      0,
      0,
      0.6);
  /* Slightly more transparent to see game behind */
  backdrop-filter: blur(4px);
  z-index: 2000;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 40rpx;
  animation: fadeIn 0.3s ease-out;
}

.summary-panel {
  width: 100%;
  max-width: 560rpx;
  background: #2c3e50;
  /* Dark Theme */
  border-radius: 20rpx;
  box-shadow: 0 20rpx 60rpx rgba(0, 0, 0, 0.5),
    0 0 0 2rpx rgba(255, 255, 255, 0.1);
  /* Subtle border glow */
  padding: 30rpx;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 20rpx;
  animation: popInSummary 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  color: #ecf0f1;
}

@keyframes popInSummary {
  from {
    opacity: 0;
    transform: scale(0.9) translateY(20rpx);
  }

  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

.summary-header {
  display: flex;
  align-items: center;
  gap: 16rpx;
  width: 100%;
  justify-content: center;
  border-bottom: 2rpx solid rgba(255, 255, 255, 0.1);
  padding-bottom: 16rpx;
  margin-bottom: 8rpx;
}

.p-avatar-small {
  width: 56rpx;
  height: 56rpx;
  border-radius: 50%;
  border: 2rpx solid #95a5a6;
}

.summary-title {
  font-size: 28rpx;
  font-weight: bold;
  color: #ecf0f1;
}

.summary-body {
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 24rpx;
}

.summary-section {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12rpx;
}

.section-label {
  font-size: 22rpx;
  color: #bdc3c7;
  font-weight: normal;
  text-transform: uppercase;
  letter-spacing: 2rpx;
}

/* Big Summary Card (Played) */
.summary-card-lg {
  width: 220rpx;
  height: 330rpx;
  position: relative;
  border-radius: 12rpx;
  box-shadow: 0 8rpx 20rpx rgba(0, 0, 0, 0.4);
  background: #34495e;
  /* Darker placeholder */
  overflow: hidden;
  border: 4rpx solid #ecf0f1;
  /* Highlight active card */
}

.card-name-label {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  background: rgba(0, 0, 0, 0.7);
  color: #fff;
  font-size: 22rpx;
  padding: 6rpx;
  text-align: center;
  font-weight: bold;
}

.fallback-card {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #95a5a6;
  color: #2c3e50;
  font-weight: bold;
  padding: 10rpx;
  text-align: center;
}

/* Discard area adjustments */
.summary-discards-scroll {
  width: 100%;
  white-space: nowrap;
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  gap: 12rpx;
  padding: 4rpx;
  min-height: 140rpx;
}

.summary-card-sm {
  width: 90rpx;
  height: 135rpx;
  flex-shrink: 0;
  border-radius: 8rpx;
  background: #34495e;
  box-shadow: 0 4rpx 10rpx rgba(0, 0, 0, 0.3);
  position: relative;
  overflow: hidden;
  opacity: 0.9;
  border: 1rpx solid rgba(255, 255, 255, 0.2);
}

.fallback-card-sm {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #7f8c8d;
  color: #ecf0f1;
  font-size: 16rpx;
  text-align: center;
  padding: 2rpx;
}

/* Log Styles */
.log-btn {
  font-size: 20rpx;
  color: #bdc3c7;
  padding: 4rpx 12rpx;
  border: 1rpx solid #7f8c8d;
  border-radius: 8rpx;
  background: rgba(0, 0, 0, 0.2);
}

.log-panel {
  max-height: 70vh !important;
  /* Override summary panel height */
  max-width: 620rpx;
}

.log-scroll {
  width: 100%;
  height: 50vh;
  margin-top: 10rpx;
  background: rgba(0, 0, 0, 0.2);
  border-radius: 8rpx;
  padding: 10rpx;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
}

.log-item {
  display: flex;
  flex-direction: row;
  align-items: flex-start;
  padding: 12rpx 0;
  border-bottom: 1rpx solid rgba(255, 255, 255, 0.05);
}

.log-time {
  font-size: 20rpx;
  color: #95a5a6;
  margin-right: 16rpx;
  min-width: 80rpx;
}

.log-text {
  font-size: 24rpx;
  color: #ecf0f1;
  flex: 1;
  word-break: break-all;
  line-height: 1.4;
}

.log-empty {
  text-align: center;
  color: #7f8c8d;
  margin-top: 40rpx;
  font-size: 24rpx;
}

.log-row-main {
  display: flex;
  flex-direction: row;
  align-items: flex-start;
  width: 100%;
}

.log-item {
  flex-direction: column !important;
  /* Override previous flex-direction row */
  align-items: flex-start !important;
}

.log-cards-row {
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  gap: 8rpx;
  padding-left: 96rpx;
  /* Indent to align with text */
  margin-top: 8rpx;
}

.log-mini-card {
  width: 60rpx;
  height: 90rpx;
  border-radius: 4rpx;
  background: #fff;
  overflow: hidden;
  box-shadow: 0 2rpx 4rpx rgba(0, 0, 0, 0.3);
  position: relative;
  border: 1rpx solid #7f8c8d;
}

.log-mini-card.paid {
  opacity: 0.6;
  /* Dim paid/discarded cards */
  transform: scale(0.9);
}

.log-mini-card.winter {
  border: 2rpx solid #3498db;
}

.log-fallback {
  width: 100%;
  height: 100%;
  background: #95a5a6;
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20rpx;
}

.card-sprite-native {
  width: 100%;
  height: 100%;
  background-repeat: no-repeat;
  position: absolute;
  top: 0;
  left: 0;
  border-radius: inherit;
}

/* 抽卡展示遮罩 */
.preview-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0, 0, 0, 0.7);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 2000;
  /* Ensure it's above everything */
  animation: fadeIn 0.2s ease-out;
}

.preview-card-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.event-header {
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  margin-bottom: 20rpx;
  gap: 12rpx;
}

.event-header .p-avatar-small {
  width: 40rpx;
  height: 40rpx;
  border-radius: 50%;
  border: 1rpx solid #fff;
  flex-shrink: 0;
  display: block;
  /* 确保图片表现为块级元素，避免inline-block的基线问题 */
}

.default-avatar {
  background-color: #ccc;
}

.event-title {
  font-size: 28rpx;
  color: #fff;
  font-weight: bold;
  text-shadow: 0 2rpx 4rpx rgba(0, 0, 0, 0.5);
  line-height: 40rpx;
  /* 与头像高度一致，确保垂直居中 */
  display: flex;
  align-items: center;
  /* 确保Emoji和文字在行内垂直对齐 */
}

/* 统一使用 140x210 尺寸，不再是巨大的 500rpx */
.main-card-display {
  width: 140rpx;
  height: 210rpx;
  position: relative;
  box-shadow: 0 0 0 4rpx #2ecc71, 0 10rpx 30rpx rgba(0, 0, 0, 0.5);
  border-radius: 8rpx;
  overflow: hidden;
  background: #34495e;
}

.sub-cards-label {
  font-size: 20rpx;
  color: #bdc3c7;
  margin: 20rpx 0 10rpx 0;
}

.sub-cards-display {
  width: 100%;
  max-width: 500rpx;
  white-space: nowrap;
  display: flex;
  justify-content: center;
  gap: 10rpx;
}

.event-sub-card {
  width: 80rpx;
  height: 120rpx;
  position: relative;
  border-radius: 4rpx;
  overflow: hidden;
  flex-shrink: 0;
  box-shadow: 0 0 0 2rpx #f1c40f, 0 4rpx 10rpx rgba(0, 0, 0, 0.3);
}

.preview-tip {
  margin-top: 30rpx;
  font-size: 32rpx;
  color: #f1c40f;
  font-weight: bold;
  text-shadow: 0 2rpx 4rpx rgba(0, 0, 0, 0.5);
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }

  to {
    opacity: 1;
  }
}

@keyframes popIn {
  0% {
    transform: scale(0.5);
    opacity: 0;
  }

  100% {
    transform: scale(1);
    opacity: 1;
  }
}

.buff-btn {
  background: rgba(241, 196, 15, 0.2);
  border: 1px solid #f1c40f;
  color: #f1c40f;
  font-size: 20rpx;
  padding: 4rpx 12rpx;
  border-radius: 8rpx;
  font-weight: bold;
  animation: pulse 3s infinite;
}

/* 堆叠数量标记 - 默认左上角 */
.stack-badge {
  position: absolute;
  top: 2rpx;
  left: 2rpx;
  background: rgba(0, 0, 0, 0.75);
  color: white;
  min-width: 26rpx;
  height: 26rpx;
  border-radius: 6rpx;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 16rpx;
  font-weight: bold;
  padding: 0 4rpx;
  box-shadow: 0 2rpx 4rpx rgba(0, 0, 0, 0.5);
  z-index: 100;
  border: 1rpx solid rgba(255, 255, 255, 0.3);
}

/* bottom 槽位的角标：左下角 */
.slot-bottom .stack-badge {
  top: auto;
  bottom: 4rpx;
  left: 4rpx;
}

/* right 槽位的角标：右上角 */
.slot-right .stack-badge {
  top: 4rpx;
  left: auto;
  right: 4rpx;
}

/* 堆叠卡牌详情弹窗 */
.stack-modal-mask {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0, 0, 0, 0.7);
  z-index: 999;
  display: flex;
  justify-content: center;
  align-items: center;
}