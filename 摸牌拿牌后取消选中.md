# 摸牌/拿牌后取消选中状态

## 问题描述

在摸牌或从空地拿牌后,牌库或空地卡牌的选中状态没有被清除,导致 UI 显示混淆,用户可能误以为还在选中状态。

## 解决方案

在摸牌和拿牌操作完成后,自动将 `selectedClearingIdx` 重置为 -1(未选中状态)。

### selectedClearingIdx 的含义

- `-1`: 未选中任何卡牌
- `-2`: 选中牌库(准备从牌库摸牌)
- `0-9`: 选中空地中对应索引的卡牌

## 修改位置

### 1. executeDrawFromDeck() - 从牌库摸牌

**文件**: `miniprogram/pages/game/game.js`  
**位置**: 第 1484-1526 行

**修改内容**:

```javascript
// 摸牌后取消牌库的选中状态
this.setData({ selectedClearingIdx: -1 });
```

**时机**: 在设置 `pendingActionToast` 之后,调用 `submitGameUpdate` 之前

### 2. onConfirmTake() - 从空地拿牌

**文件**: `miniprogram/pages/game/game.js`  
**位置**: 第 1447-1486 行

**修改内容**:

```javascript
// 拿牌后取消选中状态
this.setData({ selectedClearingIdx: -1 });
```

**时机**: 在设置 `pendingActionToast` 之后,调用 `submitGameUpdate` 之前

## 效果

### 修改前

- ✗ 摸牌后牌库仍显示为选中状态
- ✗ 拿牌后空地卡牌仍显示为选中状态
- ✗ 用户可能误以为还在选择状态

### 修改后

- ✅ 摸牌后自动取消牌库选中
- ✅ 拿牌后自动取消空地卡牌选中
- ✅ UI 状态清晰,不会产生混淆
- ✅ 用户体验更流畅

## 测试场景

### 场景 1: 从牌库摸牌

1. 点击牌库(selectedClearingIdx = -2)
2. 点击"拿取"按钮
3. 摸牌完成后,牌库不再显示选中状态 ✅

### 场景 2: 从空地拿牌

1. 点击空地某张卡(selectedClearingIdx = 索引)
2. 点击"拿取"按钮
3. 拿牌完成后,空地不再显示选中状态 ✅

### 场景 3: 连续摸牌

1. 第一次摸牌后,选中状态被清除
2. 如果还可以摸第二张,需要重新点击牌库
3. 状态管理清晰,不会出现混乱 ✅
